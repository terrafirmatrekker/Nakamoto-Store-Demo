{"ast":null,"code":"var cryptoUtils = require('./crypto/utils');\n\nvar baseX = require('base-x');\n\nvar ALLOWED_CHARS = 'rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz';\nvar codec = baseX(ALLOWED_CHARS);\nvar regexp = new RegExp('^r[' + ALLOWED_CHARS + ']{27,35}$');\nmodule.exports = {\n  /**\n   * ripple address validation\n   */\n  isValidAddress: function isValidAddress(address) {\n    if (regexp.test(address)) {\n      return this.verifyChecksum(address);\n    }\n\n    return false;\n  },\n  verifyChecksum: function verifyChecksum(address) {\n    var bytes = codec.decode(address);\n    var computedChecksum = cryptoUtils.sha256Checksum(cryptoUtils.toHex(bytes.slice(0, -4)));\n    var checksum = cryptoUtils.toHex(bytes.slice(-4));\n    return computedChecksum === checksum;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}