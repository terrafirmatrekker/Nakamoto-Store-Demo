{"ast":null,"code":"import _regeneratorRuntime from \"/Users/tejas/Desktop/marketplace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/tejas/Desktop/marketplace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/tejas/Desktop/marketplace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/tejas/Desktop/marketplace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/tejas/Desktop/marketplace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/tejas/Desktop/marketplace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/tejas/Desktop/marketplace/src/components/App.js\";\nimport React, { Component } from \"react\";\nimport Web3 from \"web3\"; //Need to correct RenJS tutorial BTC/ETH imports with newest NPM file hypehn\n\nimport RenJS from \"@renproject/ren\";\nimport { Bitcoin } from \"@renproject/chains-bitcoin\";\nimport { Ethereum } from \"@renproject/chains-ethereum\";\nimport logo from \"../logo.png\";\nimport \"./App.css\"; // import Marketplace from \"../abis/Marketplace.json\";\n\nimport ABI from \"../abis/ABI.json\";\nimport Navbar from \"./Navbar\";\nimport Main from \"./Main\"; // class dapp extends React.Component {\n//   render() {\n//     return  (\n//       <div className=\"bridge\">test\n//       <Renapp /></div>\n//     )\n//   }\n// }\n// class Store extends Component {\n//   async componentWillMount() {\n//     await this.loadWeb3();\n//     await this.loadBlockchainData();\n//   }\n//   async loadWeb3() {\n//     if (window.ethereum) {\n//       window.web3 = new Web3(window.ethereum);\n//       await window.ethereum.enable();\n//     } else if (window.web3) {\n//       window.web3 = new Web3(window.web3.currentProvider);\n//     } else {\n//       window.alert(\n//         \"Non-Ethereum browser detected. You should consider trying MetaMask!\"\n//       );\n//     }\n//   }\n//   async loadBlockchainData() {\n//     const web3 = window.web3;\n//     // Load account\n//     const accounts = await web3.eth.getAccounts();\n//     this.setState({ account: accounts[0] });\n//     const networkId = await web3.eth.net.getId();\n//     const networkData = Marketplace.networks[networkId];\n//     if (networkData) {\n//       const marketplace = web3.eth.Contract(\n//         Marketplace.abi,\n//         networkData.address\n//       );\n//       this.setState({ marketplace });\n//       const productCount = await marketplace.methods.productCount().call();\n//       this.setState({ productCount });\n//       // Load products\n//       for (var i = 1; i <= productCount; i++) {\n//         const product = await marketplace.methods.products(i).call();\n//         this.setState({\n//           products: [...this.state.products, product],\n//         });\n//       }\n//       this.setState({ loading: false });\n//     } else {\n//       window.alert(\"Marketplace contract not deployed to detected network.\");\n//     }\n//   }\n//   constructor(props) {\n//     super(props);\n//     this.state = {\n//       account: \"\",\n//       productCount: 0,\n//       products: [],\n//       loading: true,\n//     };\n//     this.createProduct = this.createProduct.bind(this);\n//     this.purchaseProduct = this.purchaseProduct.bind(this);\n//   }\n//   createProduct(name, price) {\n//     this.setState({ loading: true });\n//     this.state.marketplace.methods\n//       .createProduct(name, price)\n//       .send({ from: this.state.account })\n//       .once(\"receipt\", (receipt) => {\n//         this.setState({ loading: false });\n//       });\n//   }\n//   purchaseProduct(id, price) {\n//     this.setState({ loading: true });\n//     this.state.marketplace.methods\n//       .purchaseProduct(id)\n//       .send({ from: this.state.account, value: price })\n//       .once(\"receipt\", (receipt) => {\n//         this.setState({ loading: false });\n//       });\n//   }\n//   render() {\n//     return (\n//       <div className=\"App\">\n//         <Navbar account={this.state.account} />\n//         <div className=\"container mt-5\"> \n//           <div className=\"row\">\n//             <main role=\"main\" className=\"col-lg-12 d-flex\">\n//               {this.state.loading ? (\n//                 <div id=\"loader\" className=\"text-center\">\n//                   <p className=\"text-center\">Loading...</p>\n//                 </div>\n//               ) : (\n//                 <Main\n//                   products={this.state.products}\n//                   createProduct={this.createProduct}\n//                   purchaseProduct={this.purchaseProduct}\n//                 />\n//               )}\n//             </main>\n//           </div>\n//         </div>\n//       </div>\n//     );\n//     }\n//   }\n// Replace with your contract's address.\n\nvar contractAddress = \"0x4EaFf0d9Ce1c01910a1C4AeC87399A4caEc0a0Dd\";\n\nvar Dapp =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Dapp, _React$Component);\n\n  function Dapp(props) {\n    var _this;\n\n    _classCallCheck(this, Dapp);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Dapp).call(this, props));\n    _this.componentDidMount =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var web3Provider, web3, networkID;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!window.ethereum) {\n                _context.next = 13;\n                break;\n              }\n\n              web3Provider = window.ethereum;\n              _context.prev = 2;\n              _context.next = 5;\n              return window.ethereum.enable();\n\n            case 5:\n              _context.next = 11;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](2);\n\n              // User denied account access...\n              _this.logError(\"Please allow access to your Web3 wallet.\");\n\n              return _context.abrupt(\"return\");\n\n            case 11:\n              _context.next = 19;\n              break;\n\n            case 13:\n              if (!window.web3) {\n                _context.next = 17;\n                break;\n              }\n\n              web3Provider = window.web3.currentProvider;\n              _context.next = 19;\n              break;\n\n            case 17:\n              _this.logError(\"Please install MetaMask!\");\n\n              return _context.abrupt(\"return\");\n\n            case 19:\n              web3 = new Web3(web3Provider);\n              _context.next = 22;\n              return web3.eth.net.getId();\n\n            case 22:\n              networkID = _context.sent;\n\n              if (!(networkID !== 42)) {\n                _context.next = 26;\n                break;\n              }\n\n              _this.logError(\"Please set your network to Kovan.\");\n\n              return _context.abrupt(\"return\");\n\n            case 26:\n              _this.setState({\n                web3: web3\n              }, function () {\n                // Update balances immediately and every 10 seconds\n                _this.updateBalance();\n\n                setInterval(function () {\n                  _this.updateBalance();\n                }, 10 * 1000);\n              });\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 7]]);\n    }));\n\n    _this.render = function () {\n      var _this$state = _this.state,\n          balance = _this$state.balance,\n          message = _this$state.message,\n          error = _this$state.error;\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Balance: \", balance, \" BTC\"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: function onClick() {\n          return _this.deposit().catch(_this.logError);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, \"Deposit 0.003 BTC\")), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: function onClick() {\n          return _this.withdraw().catch(_this.logError);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Withdraw \", balance, \" BTC\")), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, message), error ? React.createElement(\"p\", {\n        style: {\n          color: \"red\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, error) : null);\n    };\n\n    _this.updateBalance =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var web3, contract, balance;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              web3 = _this.state.web3;\n              contract = new web3.eth.Contract(ABI, contractAddress);\n              _context2.next = 4;\n              return contract.methods.balance().call();\n\n            case 4:\n              balance = _context2.sent;\n\n              _this.setState({\n                balance: parseInt(balance.toString()) / Math.pow(10, 8)\n              });\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    _this.logError = function (error) {\n      console.error(error);\n\n      _this.setState({\n        error: String((error || {}).message || error)\n      });\n    };\n\n    _this.log = function (message) {\n      _this.setState({\n        message: message\n      });\n    };\n\n    _this.deposit =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4() {\n      var _this$state2, web3, renJS, amount, mint;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _this.logError(\"\"); // Reset error\n\n\n              _this$state2 = _this.state, web3 = _this$state2.web3, renJS = _this$state2.renJS;\n              amount = 0.003; // BTC\n\n              _context4.next = 5;\n              return renJS.lockAndMint({\n                // Send BTC from the Bitcoin blockchain to the Ethereum blockchain.\n                asset: \"BTC\",\n                from: Bitcoin(),\n                to: Ethereum(web3.currentProvider).Contract({\n                  // The contract we want to interact with\n                  sendTo: contractAddress,\n                  // The name of the function we want to call\n                  contractFn: \"deposit\",\n                  // Arguments expected for calling `deposit`\n                  contractParams: [{\n                    name: \"_msg\",\n                    type: \"bytes\",\n                    value: Buffer.from(\"Depositing \".concat(amount, \" BTC\"))\n                  }]\n                })\n              });\n\n            case 5:\n              mint = _context4.sent;\n\n              // Show the gateway address to the user so that they can transfer their BTC to it.\n              _this.log(\"Deposit \".concat(amount, \" BTC to \").concat(mint.gatewayAddress));\n\n              mint.on(\"deposit\",\n              /*#__PURE__*/\n              function () {\n                var _ref4 = _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee3(deposit) {\n                  var hash, depositLog;\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          // Details of the deposit are available from `deposit.depositDetails`.\n                          hash = deposit.txHash();\n\n                          depositLog = function depositLog(msg) {\n                            return _this.log(\"[\".concat(hash.slice(0, 8), \"][\").concat(deposit.status, \"] \").concat(msg));\n                          };\n\n                          _context3.next = 4;\n                          return deposit.confirmed().on(\"target\", function (confs, target) {\n                            return depositLog(\"\".concat(confs, \"/\").concat(target, \" confirmations\"));\n                          }).on(\"confirmation\", function (confs, target) {\n                            return depositLog(\"\".concat(confs, \"/\").concat(target, \" confirmations\"));\n                          });\n\n                        case 4:\n                          _context3.next = 6;\n                          return deposit.signed() // Print RenVM status - \"pending\", \"confirming\" or \"done\".\n                          .on(\"status\", function (status) {\n                            return depositLog(\"Status: \".concat(status));\n                          });\n\n                        case 6:\n                          _context3.next = 8;\n                          return deposit.mint() // Print Ethereum transaction hash.\n                          .on(\"transactionHash\", function (txHash) {\n                            return depositLog(\"Mint tx: \".concat(txHash));\n                          });\n\n                        case 8:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                }));\n\n                return function (_x) {\n                  return _ref4.apply(this, arguments);\n                };\n              }());\n\n              _this.log(\"Deposited \".concat(amount, \" BTC.\"));\n\n            case 9:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n    _this.withdraw =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee5() {\n      var _this$state3, web3, renJS, balance, recipient, amount, burnAndRelease, confirmations;\n\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _this.logError(\"\"); // Reset error\n\n\n              _this$state3 = _this.state, web3 = _this$state3.web3, renJS = _this$state3.renJS, balance = _this$state3.balance;\n              recipient = prompt(\"Enter BTC recipient:\");\n              amount = balance;\n              _context5.next = 6;\n              return renJS.burnAndRelease({\n                // Send BTC from Ethereum back to the Bitcoin blockchain.\n                asset: \"BTC\",\n                to: Bitcoin().Address(recipient),\n                from: Ethereum(web3.currentProvider).Contract(function (btcAddress) {\n                  return {\n                    sendTo: contractAddress,\n                    contractFn: \"withdraw\",\n                    contractParams: [{\n                      type: \"bytes\",\n                      name: \"_msg\",\n                      value: Buffer.from(\"Withdrawing \".concat(amount, \" BTC\"))\n                    }, {\n                      type: \"bytes\",\n                      name: \"_to\",\n                      value: Buffer.from(btcAddress)\n                    }, {\n                      type: \"uint256\",\n                      name: \"_amount\",\n                      value: RenJS.utils.toSmallestUnit(amount, 8)\n                    }]\n                  };\n                })\n              });\n\n            case 6:\n              burnAndRelease = _context5.sent;\n              confirmations = 0;\n              _context5.next = 10;\n              return burnAndRelease.burn() // Ethereum transaction confirmations.\n              .on(\"confirmation\", function (confs) {\n                confirmations = confs;\n              }) // Print Ethereum transaction hash.\n              .on(\"transactionHash\", function (txHash) {\n                return _this.log(\"txHash: \".concat(String(txHash)));\n              });\n\n            case 10:\n              _context5.next = 12;\n              return burnAndRelease.release() // Print RenVM status - \"pending\", \"confirming\" or \"done\".\n              .on(\"status\", function (status) {\n                return status === \"confirming\" ? _this.log(\"\".concat(status, \" (\").concat(confirmations, \"/15)\")) : _this.log(status);\n              }) // Print RenVM transaction hash\n              .on(\"txHash\", _this.log);\n\n            case 12:\n              _this.log(\"Withdrew \".concat(amount, \" BTC to \").concat(recipient, \".\"));\n\n            case 13:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n    _this.state = {\n      balance: 0,\n      message: \"\",\n      error: \"\",\n      renJS: new RenJS(\"testnet\")\n    };\n    return _this;\n  }\n\n  return Dapp;\n}(React.Component);\n\nexport { Dapp };","map":{"version":3,"sources":["/Users/tejas/Desktop/marketplace/src/components/App.js"],"names":["React","Component","Web3","RenJS","Bitcoin","Ethereum","logo","ABI","Navbar","Main","contractAddress","Dapp","props","componentDidMount","window","ethereum","web3Provider","enable","logError","web3","currentProvider","eth","net","getId","networkID","setState","updateBalance","setInterval","render","state","balance","message","error","deposit","catch","withdraw","color","contract","Contract","methods","call","parseInt","toString","console","String","log","renJS","amount","lockAndMint","asset","from","to","sendTo","contractFn","contractParams","name","type","value","Buffer","mint","gatewayAddress","on","hash","txHash","depositLog","msg","slice","status","confirmed","confs","target","signed","recipient","prompt","burnAndRelease","Address","btcAddress","utils","toSmallestUnit","confirmations","burn","release"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,MAAjB,C,CACA;;AACA,OAAOC,KAAP,MAAkB,iBAAlB;AACA,SAASC,OAAT,QAAwB,4BAAxB;AACA,SAASC,QAAT,QAAyB,6BAAzB;AAEA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAO,WAAP,C,CACA;;AACA,OAAOC,GAAP,MAAgB,kBAAhB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,IAAP,MAAiB,QAAjB,C,CAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA,IAAMC,eAAe,GAAG,4CAAxB;;IAEMC,I;;;;;AACJ,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8EAAMA,KAAN;AADiB,UAUnBC,iBAVmB;AAAA;AAAA;AAAA;AAAA,6BAUC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAKdC,MAAM,CAACC,QALO;AAAA;AAAA;AAAA;;AAMhBC,cAAAA,YAAY,GAAGF,MAAM,CAACC,QAAtB;AANgB;AAAA;AAAA,qBASRD,MAAM,CAACC,QAAP,CAAgBE,MAAhB,EATQ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAWd;AACA,oBAAK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","sourcesContent":["import React, { Component } from \"react\";\nimport Web3 from \"web3\";\n//Need to correct RenJS tutorial BTC/ETH imports with newest NPM file hypehn\nimport RenJS from \"@renproject/ren\";\nimport { Bitcoin } from \"@renproject/chains-bitcoin\";\nimport { Ethereum } from \"@renproject/chains-ethereum\";\n\nimport logo from \"../logo.png\";\nimport \"./App.css\";\n// import Marketplace from \"../abis/Marketplace.json\";\nimport ABI from \"../abis/ABI.json\";\nimport Navbar from \"./Navbar\";\nimport Main from \"./Main\";\n\n\n// class dapp extends React.Component {\n//   render() {\n//     return  (\n//       <div className=\"bridge\">test\n//       <Renapp /></div>\n//     )\n//   }\n// }\n\n// class Store extends Component {\n//   async componentWillMount() {\n//     await this.loadWeb3();\n//     await this.loadBlockchainData();\n//   }\n\n//   async loadWeb3() {\n//     if (window.ethereum) {\n//       window.web3 = new Web3(window.ethereum);\n//       await window.ethereum.enable();\n//     } else if (window.web3) {\n//       window.web3 = new Web3(window.web3.currentProvider);\n//     } else {\n//       window.alert(\n//         \"Non-Ethereum browser detected. You should consider trying MetaMask!\"\n//       );\n//     }\n//   }\n\n//   async loadBlockchainData() {\n//     const web3 = window.web3;\n//     // Load account\n//     const accounts = await web3.eth.getAccounts();\n//     this.setState({ account: accounts[0] });\n//     const networkId = await web3.eth.net.getId();\n//     const networkData = Marketplace.networks[networkId];\n//     if (networkData) {\n//       const marketplace = web3.eth.Contract(\n//         Marketplace.abi,\n//         networkData.address\n//       );\n//       this.setState({ marketplace });\n//       const productCount = await marketplace.methods.productCount().call();\n//       this.setState({ productCount });\n//       // Load products\n//       for (var i = 1; i <= productCount; i++) {\n//         const product = await marketplace.methods.products(i).call();\n//         this.setState({\n//           products: [...this.state.products, product],\n//         });\n//       }\n//       this.setState({ loading: false });\n//     } else {\n//       window.alert(\"Marketplace contract not deployed to detected network.\");\n//     }\n//   }\n\n//   constructor(props) {\n//     super(props);\n//     this.state = {\n//       account: \"\",\n//       productCount: 0,\n//       products: [],\n//       loading: true,\n//     };\n\n//     this.createProduct = this.createProduct.bind(this);\n//     this.purchaseProduct = this.purchaseProduct.bind(this);\n//   }\n\n//   createProduct(name, price) {\n//     this.setState({ loading: true });\n//     this.state.marketplace.methods\n//       .createProduct(name, price)\n//       .send({ from: this.state.account })\n//       .once(\"receipt\", (receipt) => {\n//         this.setState({ loading: false });\n//       });\n//   }\n\n//   purchaseProduct(id, price) {\n//     this.setState({ loading: true });\n//     this.state.marketplace.methods\n//       .purchaseProduct(id)\n//       .send({ from: this.state.account, value: price })\n//       .once(\"receipt\", (receipt) => {\n//         this.setState({ loading: false });\n//       });\n//   }\n\n//   render() {\n//     return (\n//       <div className=\"App\">\n//         <Navbar account={this.state.account} />\n//         <div className=\"container mt-5\"> \n//           <div className=\"row\">\n//             <main role=\"main\" className=\"col-lg-12 d-flex\">\n//               {this.state.loading ? (\n//                 <div id=\"loader\" className=\"text-center\">\n//                   <p className=\"text-center\">Loading...</p>\n//                 </div>\n//               ) : (\n//                 <Main\n//                   products={this.state.products}\n//                   createProduct={this.createProduct}\n//                   purchaseProduct={this.purchaseProduct}\n//                 />\n//               )}\n//             </main>\n//           </div>\n//         </div>\n//       </div>\n//     );\n//     }\n//   }\n\n// Replace with your contract's address.\nconst contractAddress = \"0x4EaFf0d9Ce1c01910a1C4AeC87399A4caEc0a0Dd\";\n\nclass Dapp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      balance: 0,\n      message: \"\",\n      error: \"\",\n      renJS: new RenJS(\"testnet\"),\n    };\n  }\n\n  componentDidMount = async () => {\n    let web3Provider;\n\n    // Initialize web3 (https://medium.com/coinmonks/web3-js-ethereum-javascript-api-72f7b22e2f0a)\n    // Modern dApp browsers...\n    if (window.ethereum) {\n      web3Provider = window.ethereum;\n      try {\n        // Request account access\n        await window.ethereum.enable();\n      } catch (error) {\n        // User denied account access...\n        this.logError(\"Please allow access to your Web3 wallet.\");\n        return;\n      }\n    }\n    // Legacy dApp browsers...\n    else if (window.web3) {\n      web3Provider = window.web3.currentProvider;\n    }\n    // If no injected web3 instance is detected, fall back to Ganache\n    else {\n      this.logError(\"Please install MetaMask!\");\n      return;\n    }\n\n    const web3 = new Web3(web3Provider);\n\n    const networkID = await web3.eth.net.getId();\n    if (networkID !== 42) {\n      this.logError(\"Please set your network to Kovan.\");\n      return;\n    }\n\n    this.setState({ web3 }, () => {\n      // Update balances immediately and every 10 seconds\n      this.updateBalance();\n      setInterval(() => {\n        this.updateBalance();\n      }, 10 * 1000);\n    });\n  };\n\n  render = () => {\n    const { balance, message, error } = this.state;\n    return (\n      <div className=\"App\">\n        <p>Balance: {balance} BTC</p>\n        <p>\n          <button onClick={() => this.deposit().catch(this.logError)}>\n            Deposit 0.003 BTC\n          </button>\n        </p>\n        <p>\n          <button onClick={() => this.withdraw().catch(this.logError)}>\n            Withdraw {balance} BTC\n          </button>\n        </p>\n        <p>{message}</p>\n        {error ? <p style={{ color: \"red\" }}>{error}</p> : null}\n      </div>\n    );\n  };\n\n  updateBalance = async () => {\n    const { web3 } = this.state;\n    const contract = new web3.eth.Contract(ABI, contractAddress);\n    const balance = await contract.methods.balance().call();\n    this.setState({ balance: parseInt(balance.toString()) / 10 ** 8 });\n  };\n\n  logError = (error) => {\n    console.error(error);\n    this.setState({ error: String((error || {}).message || error) });\n  };\n\n  log = (message) => {\n    this.setState({ message });\n  };\n\n  deposit = async () => {\n    this.logError(\"\"); // Reset error\n\n    const { web3, renJS } = this.state;\n\n    const amount = 0.003; // BTC\n    const mint = await renJS.lockAndMint({\n      // Send BTC from the Bitcoin blockchain to the Ethereum blockchain.\n      asset: \"BTC\",\n      from: Bitcoin(),\n      to: Ethereum(web3.currentProvider).Contract({\n        // The contract we want to interact with\n        sendTo: contractAddress,\n\n        // The name of the function we want to call\n        contractFn: \"deposit\",\n\n        // Arguments expected for calling `deposit`\n        contractParams: [\n          {\n            name: \"_msg\",\n            type: \"bytes\",\n            value: Buffer.from(`Depositing ${amount} BTC`),\n          },\n        ],\n      }),\n    });\n\n    // Show the gateway address to the user so that they can transfer their BTC to it.\n    this.log(`Deposit ${amount} BTC to ${mint.gatewayAddress}`);\n\n    mint.on(\"deposit\", async (deposit) => {\n      // Details of the deposit are available from `deposit.depositDetails`.\n\n      const hash = deposit.txHash();\n      const depositLog = (msg) =>\n        this.log(`[${hash.slice(0, 8)}][${deposit.status}] ${msg}`);\n\n      await deposit\n        .confirmed()\n        .on(\"target\", (confs, target) =>\n          depositLog(`${confs}/${target} confirmations`)\n        )\n        .on(\"confirmation\", (confs, target) =>\n          depositLog(`${confs}/${target} confirmations`)\n        );\n\n      await deposit\n        .signed()\n        // Print RenVM status - \"pending\", \"confirming\" or \"done\".\n        .on(\"status\", (status) => depositLog(`Status: ${status}`));\n\n      await deposit\n        .mint()\n        // Print Ethereum transaction hash.\n        .on(\"transactionHash\", (txHash) => depositLog(`Mint tx: ${txHash}`));\n    });\n\n    this.log(`Deposited ${amount} BTC.`);\n  };\n\n  withdraw = async () => {\n    this.logError(\"\"); // Reset error\n\n    const { web3, renJS, balance } = this.state;\n\n    const recipient = prompt(\"Enter BTC recipient:\");\n    const amount = balance;\n    const burnAndRelease = await renJS.burnAndRelease({\n      // Send BTC from Ethereum back to the Bitcoin blockchain.\n      asset: \"BTC\",\n      to: Bitcoin().Address(recipient),\n      from: Ethereum(web3.currentProvider).Contract((btcAddress) => ({\n        sendTo: contractAddress,\n\n        contractFn: \"withdraw\",\n\n        contractParams: [\n          {\n            type: \"bytes\",\n            name: \"_msg\",\n            value: Buffer.from(`Withdrawing ${amount} BTC`),\n          },\n          {\n            type: \"bytes\",\n            name: \"_to\",\n            value: Buffer.from(btcAddress),\n          },\n          {\n            type: \"uint256\",\n            name: \"_amount\",\n            value: RenJS.utils.toSmallestUnit(amount, 8),\n          },\n        ],\n      })),\n    });\n\n    let confirmations = 0;\n    await burnAndRelease\n      .burn()\n      // Ethereum transaction confirmations.\n      .on(\"confirmation\", (confs) => {\n        confirmations = confs;\n      })\n      // Print Ethereum transaction hash.\n      .on(\"transactionHash\", (txHash) => this.log(`txHash: ${String(txHash)}`));\n\n    await burnAndRelease\n      .release()\n      // Print RenVM status - \"pending\", \"confirming\" or \"done\".\n      .on(\"status\", (status) =>\n        status === \"confirming\"\n          ? this.log(`${status} (${confirmations}/15)`)\n          : this.log(status)\n      )\n      // Print RenVM transaction hash\n      .on(\"txHash\", this.log);\n\n    this.log(`Withdrew ${amount} BTC to ${recipient}.`);\n  };\n}\n\nexport {\n\n  Dapp,\n}"]},"metadata":{},"sourceType":"module"}