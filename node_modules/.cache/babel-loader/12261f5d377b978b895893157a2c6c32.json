{"ast":null,"code":"var cryptoUtils = require('./crypto/utils');\n\nvar baseX = require('base-x');\n\nvar ALLOWED_CHARS = '13456789abcdefghijkmnopqrstuwxyz';\nvar codec = baseX(ALLOWED_CHARS); // https://github.com/nanocurrency/raiblocks/wiki/Accounts,-Keys,-Seeds,-and-Wallet-Identifiers\n\nvar regexp = new RegExp('^(xrb|nano)_([' + ALLOWED_CHARS + ']{60})$');\nmodule.exports = {\n  isValidAddress: function isValidAddress(address) {\n    if (regexp.test(address)) {\n      return this.verifyChecksum(address);\n    }\n\n    return false;\n  },\n  verifyChecksum: function verifyChecksum(address) {\n    var bytes = codec.decode(regexp.exec(address)[2]).slice(-37); // https://github.com/nanocurrency/raiblocks/blob/master/rai/lib/numbers.cpp#L73\n\n    var computedChecksum = cryptoUtils.blake2b(cryptoUtils.toHex(bytes.slice(0, -5)), 5);\n    var checksum = cryptoUtils.toHex(bytes.slice(-5).reverse());\n    return computedChecksum === checksum;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}